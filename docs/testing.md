## 7. TESTING

### 7.1 Unit Testing â€“ Test Cases

| Test Case ID | Module                                 | Test Scenario                                           | Input                                                                                                | Expected Output                                                                 | Actual Output | Status (Pass/Fail) |
| ------------ | -------------------------------------- | ------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------- | ------------- | ------------------ |
| UTC-001      | `lib/supabase.ts`                      | Create or fetch user by email                           | `{ firstName: "Jane", lastName: "Doe", email: "j@e.com", phone: "9999999999", organization: "ABC" }` | Existing user returned or new user row created with matching email              | As expected   | Pass               |
| UTC-002      | `lib/supabase.ts`                      | Create single event registration                        | `{ userId, eventSlug: "code-loom", orderId: "ORD123", amount: 300 }`                                 | Row created in `registrations` with `payment_status = 'pending'`                | As expected   | Pass               |
| UTC-003      | `lib/supabase.ts`                      | Fetch event by slug                                     | `"trail-hack"`                                                                                       | Event row returned with matching `slug` and fields (price, name)                | As expected   | Pass               |
| UTC-004      | `lib/types/payment.ts`                 | Zod validation for create-order payload (valid)         | `{ orderId:"ORD1", orderAmount:"300", customerName:"Jane", customerEmail:"j@e.com" }`                | Schema validates, parsed object returned                                        | As expected   | Pass               |
| UTC-005      | `lib/types/payment.ts`                 | Zod validation for create-order payload (invalid email) | `{ orderId:"ORD1", orderAmount:"300", customerName:"Jane", customerEmail:"bad" }`                    | Zod error for invalid email                                                     | As expected   | Pass               |
| UTC-006      | `app/api/create-order/route.ts`        | Create Cashfree order with valid env                    | Valid JSON body (per schema) and app env set                                                         | 200 OK; JSON includes `paymentSessionId`/redirect meta; logs include order data | As expected   | Pass               |
| UTC-007      | `app/api/create-order/route.ts`        | Fail when credentials missing                           | Same body; `CASHFREE_APP_ID` unset                                                                   | 500 with `{ error: "Cashfree credentials not configured" }`                     | As expected   | Pass               |
| UTC-008      | `app/api/payment-webhook/route.ts`     | Validate webhook body (valid)                           | Sample webhook JSON with `PAID`/`SUCCESS` and numeric amount string                                  | 200 OK; logs paid order; ready to update DB                                     | As expected   | Pass               |
| UTC-009      | `app/api/payment-webhook/route.ts`     | Reject invalid webhook body                             | `{ orderId:"", paymentStatus:"BAD" }`                                                                | 400 with `{ error: "Invalid webhook data" }` and details array                  | As expected   | Pass               |
| UTC-010      | `app/register/[formType]/page.tsx`     | Form validation via Zod resolver (required fields)      | Submit without email                                                                                 | Inline error shown for email; submit prevented                                  | As expected   | Pass               |
| UTC-011      | `app/register/[formType]/page.tsx`     | Launch Cashfree checkout on valid submit                | Valid form submit                                                                                    | Cashfree `checkout` invoked with session; redirect or popup                     | As expected   | Pass               |
| UTC-012      | `app/admin/page.tsx`                   | Filter by payment status                                | Click "paid" filter                                                                                  | List shows only `payment_status === 'paid'` rows                                | As expected   | Pass               |
| UTC-013      | `app/admin/page.tsx`                   | Debounced search by name                                | Type "Jane" in search                                                                                | Results filtered by user full name after ~300ms                                 | As expected   | Pass               |
| UTC-014      | `app/admin/page.tsx`                   | Participation confirm toggle                            | Click Confirm on a `paid` registration                                                               | `participation_confirmed` set true in DB; UI reflects change                    | As expected   | Pass               |
| UTC-015      | `components/ui/certificate-sender.tsx` | Bulk select and send (UI flow)                          | Select 2 participants, click Send                                                                    | Loading state shown; completion clears selection                                | As expected   | Pass               |

Notes:

- Inputs/outputs align with current schemas and endpoints. Replace example values with fixture data for automated tests.
- Webhook signature verification should be covered in integration tests once implemented.
